transformers_commit := 63d5605212c5d88c0cc29996b3bf76840bdd1489

transformers:
	# Clone fork of transformers with custom CUDA kernels and sharding logic
	pip install --upgrade setuptools
	git clone https://github.com/OlivierDehaene/transformers.git

build-transformers: transformers
	cd transformers && git fetch && git checkout $(transformers_commit) && python setup.py build

install-transformers: build-transformers
	pip uninstall transformers -y || true
	cd transformers && python setup.py install