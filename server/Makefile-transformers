transformers_commit := b8d969ff47c6a9d40538a6ea33df021953363afc

transformers:
	# Install specific version of transformers with custom cuda kernels
	pip install --upgrade setuptools
	git clone https://github.com/OlivierDehaene/transformers.git
	cd transformers && git checkout $(transformers_commit)

transformers/build: transformers
	cd transformers && git checkout $(transformers_commit)
	cd transformers && python setup.py build

build-transformers: transformers/build

install-transformers: build-transformers
	pip uninstall transformers -y || true
	cd transformers && python setup.py install